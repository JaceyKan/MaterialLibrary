<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8">
		<title>动态海浪背景</title>
		<style>
			/*设置背景样式*/
			#bg {
				position: absolute;
				top: 0;
				left: 0;
				z-index: -100;
				height: 100%;
				width: 100%;
			}

			header {
				text-align: center;
			}

			footer {
				position: absolute;
				bottom: 0;
				left: 0;
				right: 0;
				text-align: center;
			}
		</style>
	</head>
	<body>
		<canvas id="bg"></canvas> <!--背景-->

		<div id="container">
			<header>
				<h1>出自<a href="https://github.com/jaceykan/MaterialLibrary" target="_blank">Jacey Kan</a>的素材库</h1>
			</header>
			<h2>canvas制作波浪状动态背景</h2>
			<p>
			作品原创自 <b><a href="https://github.com/cyclegtx/wave_background" target="_blank">cyclegtx</a></b>
			详细教程见作者的github <br>
			本人在原作基础上有稍加修改整合。
			</p>
		</div>

		<footer>
			<a href="https://github.com/JaceyKan/MaterialLibrary/blob/master/wavingBackground.html" target="_blank">源代码</a>详见<b>JaceyKan</b>的素材库
			<p>
				喜欢给个<b>star</b>吧
			</p>
		</footer>
		<script>
			var canvas = document.getElementById("bg");
			var ctx = canvas.getContext("2d");

			//用于支持动画，1秒钟变换60次图像形成动画。
			window.requestAnimFrame = (function(){
				return window.requestAnimationFrame ||
					   window.webkitRequestAnimationFrame ||
					   window.mozRequestAnimationFrame ||
					   function( callback ){
					   	window.setTimeout(callback, 1000/60);
					   };
			})();

			//画波浪
			//color: 波浪的颜色
			//angel: 正弦、余弦函数的角度值，控制左、右上角的高度
			//range: 波浪高度变化范围，控件波浪大小
			function drawWave(color, angle, range){
				ctx.fillStyle = color;  //填充颜色
				
				var radian = angle*Math.PI/180; //角度转换成弧度
				var deltaHeightLeft = Math.sin(radian) * range;  //矩形高度的变化量（左上顶点）
				var deltaHeightRight = Math.cos(radian) * range;//矩形高度的变化量（右上顶点）
				ctx.beginPath();  //开始绘制路径
				ctx.moveTo(0, canvas.height/2+deltaHeightLeft); //左上角
				ctx.bezierCurveTo(canvas.width/2, canvas.height/2+deltaHeightLeft-range, canvas.width/2, canvas.height/2+deltaHeightRight-range, canvas.width, canvas.height/2+deltaHeightRight); //画曲线
				ctx.lineTo(canvas.width, canvas.height/2+deltaHeightRight);  //右上角
				ctx.lineTo(canvas.width, canvas.height); //右下角
				ctx.lineTo(0, canvas.height); //左下角
				ctx.lineTo(0, canvas.height/2+deltaHeightLeft);
				ctx.closePath();  //闭合路径
				ctx.fill();  //填充路径
			}
			//drawWave("rgba(0,222,255,0.2)", 90, canvas.height/8);

			var waveColors = ["rgba(0,222,255,0.2)",
						 "rgba(157,192,249,0.2)",
						 "rgba(0,168,255,0.2)"];
			var range = canvas.height/8;
			var step = 0;

			function loop(){
				step++;
				ctx.clearRect(0,0,canvas.width,canvas.height);  //清空canvas

				//画多个波浪
				for(var i=0; i<waveColors.length; i++){
					angle = step + i*45;
					var color = waveColors[i];
					drawWave(color, angle, range);
					
				}
				requestAnimFrame(loop); //回调loop函数
			}

			loop();
		</script>
	</body>
</html>